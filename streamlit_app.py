import streamlit as st
import numpy as np

st.set_page_config(page_title="–ü—Ä–æ–≥–Ω–æ–∑ —Å–µ—Ä–æ–º—ã", layout="centered")

st.title("üìä –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —Å–µ—Ä–æ–º—ã")
st.write("–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–∞—Ü–∏–µ–Ω—Ç–∞, —á—Ç–æ–±—ã —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å —Ä–∏—Å–∫ —Ä–∞–∑–≤–∏—Ç–∏—è –ø–æ—Å–ª–µ–æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–µ—Ä–æ–º—ã")

# –í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö
BMI = st.number_input("–ò–Ω–¥–µ–∫—Å –º–∞—Å—Å—ã —Ç–µ–ª–∞ (–ò–ú–¢)", 15.0, 50.0, step=0.1)
has_htn = st.checkbox("–ì–∏–ø–µ—Ä—Ç–æ–Ω–∏—á–µ—Å–∫–∞—è –±–æ–ª–µ–∑–Ω—å")
surgery_type = st.selectbox("–¢–∏–ø –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞", ["eTEP", "TAPP"])
had_prev_op = st.checkbox("–†–∞–Ω–µ–µ –ø—Ä–æ–≤–æ–¥–∏–º–æ–µ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ –≤ –ø–∞—Ö–æ–≤–æ–π –æ–±–ª–∞—Å—Ç–∏")

# –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã (–ø—Ä–∏–º–µ—Ä –∏–∑ –≤–∞—à–µ–π –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –º–æ–¥–µ–ª–∏)
B0 = -2.0
B_BMI = 1.541
B_HTN = 3.196
B_SURG_TYPE = 6.063      # TAPP = 1, eTEP = 0
B_PREV_OP = -3.389       # –¥–∞ = 1, –Ω–µ—Ç = 0

# –ö–æ–¥–∏—Ä–æ–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
x_BMI = BMI
x_HTN = 1 if has_htn else 0
x_SURG = 1 if surgery_type == "TAPP" else 0
x_PREV_OP = 1 if had_prev_op else 0

# –†–∞—Å—á—ë—Ç –ª–æ–≥–∏—Ç–∞
logit = B0 + B_BMI * x_BMI + B_HTN * x_HTN + B_SURG_TYPE * x_SURG + B_PREV_OP * x_PREV_OP
prob = 1 / (1 + np.exp(-logit))  # –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è

# –†–µ–∑—É–ª—å—Ç–∞—Ç
st.subheader("üîé –†–µ–∑—É–ª—å—Ç–∞—Ç—ã")
st.success(f"–†–∞—Å—Å—á–∏—Ç–∞–Ω–Ω–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–µ—Ä–æ–º—ã: **{prob*100:.2f}%**")
st.progress(min(max(float(prob), 0), 1))